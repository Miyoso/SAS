<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAS - INVESTIGATION WALL</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style-mo.css">
    <link rel="stylesheet" href="css/investigation.css">
    <script src="https://js.pusher.com/8.2.0/pusher.min.js"></script>
</head>
<body>

<div class="crt-overlay"></div>
<div class="tactical-grid"></div>

<div id="board-viewport">
    <div id="board-world">
        <svg id="connections-layer"></svg>
    </div>
</div>

<div class="hud-overlay">
    <h1>INVESTIGATION <span style="color:var(--danger)">BOARD</span></h1>

    <div class="tools">
        <button onclick="createNode('target')">+ CIBLE</button>
        <button onclick="createNode('evidence')">+ PREUVE</button>
        <button onclick="createNode('location')">+ LIEU</button>
        <button onclick="createNode('note')" style="color:#ffd700; border-color:#ffd700;">+ NOTE</button>

        <div class="separator"></div>

        <div class="color-picker-group">
            <div class="color-dot active" style="background:#ff3333;" onclick="setLinkColor('#ff3333', this)"></div>
            <div class="color-dot" style="background:#00ff9d;" onclick="setLinkColor('#00ff9d', this)"></div>
            <div class="color-dot" style="background:#00f3ff;" onclick="setLinkColor('#00f3ff', this)"></div>
            <div class="color-dot" style="background:#eebb00;" onclick="setLinkColor('#eebb00', this)"></div>
            <div class="color-dot" style="background:#ffffff;" onclick="setLinkColor('#ffffff', this)"></div>
        </div>

        <button onclick="toggleLinkMode()" id="btn-link">ðŸ”— LIER</button>
    </div>
</div>

<div id="creation-modal" class="modal-overlay hidden">
    <div class="modal-box">
        <h2 class="modal-title">NOUVEL Ã‰LÃ‰MENT</h2>

        <div class="form-group">
            <label>TYPE</label>
            <div class="type-selector">
                <button class="type-btn active" onclick="setModalType('target')" id="btn-type-target">CIBLE</button>
                <button class="type-btn" onclick="setModalType('evidence')" id="btn-type-evidence">PREUVE</button>
                <button class="type-btn" onclick="setModalType('location')" id="btn-type-location">LIEU</button>
                <button class="type-btn" onclick="setModalType('note')" id="btn-type-note">NOTE</button>
            </div>
        </div>

        <div class="form-group">
            <label>TITRE / NOM</label>
            <input type="text" id="inp-label" placeholder="Nom du dossier...">
        </div>

        <div class="form-group">
            <label>CONTENU / INFO</label>
            <input type="text" id="inp-sub" placeholder="Info complÃ©mentaire...">
        </div>

        <div class="form-group" id="group-img">
            <label>IMAGE (URL)</label>
            <input type="text" id="inp-img" placeholder="https://i.goopics.net/...">
            <small style="color:#666; font-size:0.7rem;">Laisser vide pour image par dÃ©faut.</small>
        </div>

        <div class="modal-actions">
            <button onclick="closeModal()" class="btn-cancel">ANNULER</button>
            <button onclick="confirmCreateNode()" class="btn-confirm">CONFIRMER</button>
        </div>
    </div>
</div>

<div id="case-sidebar" class="case-sidebar">
    <div class="sidebar-header">
        <span>ARCHIVES // DOSSIERS</span>
        <button onclick="toggleSidebar()" style="background:none; border:none; color:#fff; cursor:pointer;">â—€</button>
    </div>

    <div class="new-case-form">
        <input type="text" id="new-case-title" placeholder="NOM DU DOSSIER...">
        <button onclick="createNewBoard()">+</button>
    </div>

    <div id="case-list" class="case-list">
        <div class="blink">CHARGEMENT...</div>
    </div>
</div>

<button id="btn-open-sidebar" onclick="toggleSidebar()">ðŸ“‚ DOSSIERS</button>

<div id="sidebar-placeholder"></div>

<script src="js/script.js"></script>
<script src="js/investigation.js"></script>
<script src="js/collaboration.js"></script>

<script>
    const session = JSON.parse(localStorage.getItem('sas_session')) || { username: 'GHOST' };
    if (typeof SAS_COLLAB !== 'undefined') {
        SAS_COLLAB.init(session.username, '#00ff9d');
    }
</script>
</body>
</html>